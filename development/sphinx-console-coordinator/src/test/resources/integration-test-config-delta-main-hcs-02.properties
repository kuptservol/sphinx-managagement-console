delta.main.collection.name = hcs_quick
delta.main.datasource.type=pgsql
delta.main.datasource.host=195.26.187.155
delta.main.datasource.username=hcs_srch_demo_rw
delta.main.datasource.password=hcs_srch_demo_rw
delta.main.datasource.db=hcssrchdb_demo
delta.main.datasource.port=5432
delta.main.mainsql.query =  select \
                              id, \
                              entity_uid, \
                              entity_title, \
                              entity_date, \
                              entity_text, \
                              entity_category, \
                              entity_type, \
                              ft_identifying_numbers, \
                              ft_location, \
                              ft_name, \
                              ft_description, \
                              ft_short_name, \
                              ft_tag, \
                              ft_text_files, \
                              entity_file_name, \
                              entity_location, \
                              entity_year, \
                              longitude, \
                              latitude, \
                              entity_ogrn, \
                              entity_inn, \
                              entity_deleted, \
                              entity_role_codes, \
                              entity_link \
                            from \
                              ( \
                            select \
                              id                  id, \
                              file_guids          entity_uid, \
                              title               entity_title, \
                              round(extract(epoch from acceptance_date)::numeric)::varchar entity_date, \
                              doc_numbers         entity_text, \
                              'DISCOUNT_DOCUMENT' entity_category, \
                              '2'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              ''                  ft_tag, \
                              converted_content   ft_text_files, \
                              file_name           entity_file_name, \
                              ''                  entity_location, \
                              ''                  entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_doc_discounts \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              file_guids          entity_uid, \
                              title               entity_title, \
                              round(extract(epoch from acceptance_date)::numeric)::varchar entity_date, \
                              doc_numbers         entity_text, \
                              'LAW_DOCUMENT'      entity_category, \
                              '3'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              title               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              ''                  ft_tag, \
                              converted_content   ft_text_files, \
                              file_name           entity_file_name, \
                              ''                  entity_location, \
                              ''                  entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_doc_laws \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              title               entity_title, \
                              ''                  entity_date, \
                              municipal_services  entity_text, \
                              'RATE_DOCUMENT'     entity_category, \
                              '4'                 entity_type, \
                              ''                  ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              converted_content   ft_text_files, \
                              file_name           entity_file_name, \
                              subject             entity_location, \
                              to_char(effective_period_to, 'YYYY') entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_doc_rates \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              address             entity_title, \
                              ''                  entity_date, \
                              ('\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u044B\u0439 \u043F\u0430\u0441\u043F\u043E\u0440\u0442 \u0434\u043E\u043C\u0430. \u041E\u0442\u0447\u0435\u0442\u043D\u044B\u0439 \u043F\u0435\u0440\u0438\u043E\u0434: ' || reporting_period_month || '.' || reporting_period_year) entity_text, \
                              'EP_JD'             entity_category, \
                              '10'                entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              address             entity_location, \
                              to_char(reporting_period_year, 'YYYY') entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              object_guid         entity_link \
                            FROM srchsm_demo.search_passports_dwelling \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              address             entity_title, \
                              ''                  entity_date, \
                              ('\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u044B\u0439 \u043F\u0430\u0441\u043F\u043E\u0440\u0442 \u0434\u043E\u043C\u0430. \u041E\u0442\u0447\u0435\u0442\u043D\u044B\u0439 \u043F\u0435\u0440\u0438\u043E\u0434: ' || reporting_period_month || '.' || reporting_period_year) entity_text, \
                              'EP_MKD'            entity_category, \
                              '9'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              address             entity_location, \
                              to_char(reporting_period_year, 'YYYY') entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              object_guid         entity_link \
                            FROM srchsm_demo.search_passports_apartment \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              address             entity_title, \
                              ''                  entity_date, \
                              house_type_name     entity_text, \
                              'HOUSES'            entity_category, \
                              '7'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              address             entity_location, \
                              ''                  entity_year, \
                              longitude::varchar           longitude, \
                              latitude::varchar            latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_houses \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              names               entity_title, \
                              round(extract(epoch from last_changed_date)::numeric)::varchar entity_date, \
                              oktmo_full_name     entity_text, \
                              'INFRASTRUCTURE_DOCUMENTS'     entity_category, \
                              '11'                entity_type, \
                              ''                  ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              oktmo_full_name     ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              ''                  entity_location, \
                              to_char(reporting_period_year, 'YYYY') entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_infr_documents \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              title               entity_title, \
                              round(extract(epoch from publish_date)::numeric)::varchar entity_date, \
                              short_text          entity_text, \
                              'News'              entity_category, \
                              '1'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              descriptions        ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              ''                  entity_location, \
                              ''                  entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_news \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              organization_name   entity_title, \
                              ''                  entity_date, \
                              roles               entity_text, \
                              'ORGANIZATIONS'     entity_category, \
                              '8'                 entity_type, \
                              doc_numbers         ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              ''                  ft_description, \
                              ''                  ft_short_name, \
                              ''                  ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              fact_addr           entity_location, \
                              ''                  entity_year, \
                              longitude::varchar           longitude, \
                              latitude::varchar            latitude, \
                              ogrn                entity_ogrn, \
                              inn                 entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_organizations \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              title               entity_title, \
                              round(extract(epoch from event_date)::numeric)::varchar entity_date, \
                              ''                  entity_text, \
                              'PEOPLE_EVENTS'     entity_category, \
                              '5'                 entity_type, \
                              ''                  ft_identifying_numbers, \
                              place               ft_location, \
                              names               ft_name, \
                              descriptions        ft_description, \
                              ''                  ft_short_name, \
                              tegs                ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              place               entity_location, \
                              ''                  entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              ''                  entity_link \
                            FROM srchsm_demo.search_people_events \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            UNION ALL \
                            select \
                              id                  id, \
                              object_guid         entity_uid, \
                              link_name           entity_title, \
                              ''                  entity_date, \
                              link_desc           entity_text, \
                              'USEFULL_LINKS'     entity_category, \
                              '6'                 entity_type, \
                              ''                  ft_identifying_numbers, \
                              ''                  ft_location, \
                              names               ft_name, \
                              descriptions        ft_description, \
                              ''                  ft_short_name, \
                              ''                  ft_tag, \
                              ''                  ft_text_files, \
                              ''                  entity_file_name, \
                              ''                  entity_location, \
                              ''                  entity_year, \
                              ''                  longitude, \
                              ''                  latitude, \
                              ''                  entity_ogrn, \
                              ''                  entity_inn, \
                              0                   entity_deleted, \
                              ''                  entity_role_codes, \
                              link_url            entity_link \
                            FROM srchsm_demo.search_useful_links \
                            WHERE indexing_ready = true \
                                  AND id >= $start AND id <= $end \
                            ) as alltbls
delta.main.main.sql_query_range = select min(min_id), max(max_id) from ( \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_doc_discounts \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_doc_laws \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_doc_rates \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_passports_dwelling \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_passports_apartment \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_houses \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_infr_documents \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_news \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_organizations \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_people_events \
                                    UNION ALL \
                                    SELECT min(id) min_id, max(id) max_id FROM srchsm_demo.search_useful_links \
                                  ) extr
delta.main.main.sql_range_step =
delta.main.deltasql.query = select  \
                              id, \
                              entity_uid, \
                              entity_title, \
                              entity_date, \
                              entity_text, \
                              entity_category, \
                              entity_type, \
                              ft_identifying_numbers, \
                              ft_location, \
                              ft_name, \
                              ft_description, \
                              ft_short_name, \
                              ft_tag, \
                              ft_text_files, \
                              entity_file_name, \
                              entity_location, \
                              entity_year, \
                              longitude, \
                              latitude, \
                              entity_ogrn, \
                              entity_inn, \
                              entity_deleted, \
                              entity_role_codes, \
                              entity_link \
                            from ( \
                              SELECT \
                                id                                                               id, \
                                file_guids                                                       entity_uid, \
                                title                                                            entity_title, \
                                round(extract(EPOCH FROM acceptance_date) :: NUMERIC) :: VARCHAR entity_date, \
                                doc_numbers                                                      entity_text, \
                                'DISCOUNT_DOCUMENT'                                              entity_category, \
                                '2'                                                              entity_type, \
                                doc_numbers                                                      ft_identifying_numbers, \
                                place                                                            ft_location, \
                                names                                                            ft_name, \
                                ''                                                               ft_description, \
                                ''                                                               ft_short_name, \
                                ''                                                               ft_tag, \
                                converted_content                                                ft_text_files, \
                                file_name                                                        entity_file_name, \
                                ''                                                               entity_location, \
                                ''                                                               entity_year, \
                                ''                                                               longitude, \
                                ''                                                               latitude, \
                                ''                                                               entity_ogrn, \
                                ''                                                               entity_inn, \
                                0                                                                entity_deleted, \
                                ''                                                               entity_role_codes, \
                                ''                                                               entity_link \
                              FROM srchsm_demo.search_doc_discounts s \
                              WHERE \
                                s.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_ws l \
                                  WHERE l.object_type = 'WS' \
                                        AND l.object_id = s.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                                               id, \
                                file_guids                                                       entity_uid, \
                                title                                                            entity_title, \
                                round(extract(EPOCH FROM acceptance_date) :: NUMERIC) :: VARCHAR entity_date, \
                                doc_numbers                                                      entity_text, \
                                'LAW_DOCUMENT'                                                   entity_category, \
                                '3'                                                              entity_type, \
                                doc_numbers                                                      ft_identifying_numbers, \
                                place                                                            ft_location, \
                                title                                                            ft_name, \
                                ''                                                               ft_description, \
                                ''                                                               ft_short_name, \
                                ''                                                               ft_tag, \
                                converted_content                                                ft_text_files, \
                                file_name                                                        entity_file_name, \
                                ''                                                               entity_location, \
                                ''                                                               entity_year, \
                                ''                                                               longitude, \
                                ''                                                               latitude, \
                                ''                                                               entity_ogrn, \
                                ''                                                               entity_inn, \
                                0                                                                entity_deleted, \
                                ''                                                               entity_role_codes, \
                                ''                                                               entity_link \
                              FROM srchsm_demo.search_doc_laws z \
                              WHERE \
                                z.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wz l \
                                  WHERE l.object_type = 'WZ' \
                                        AND l.object_id = z.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                   id, \
                                object_guid                          entity_uid, \
                                title                                entity_title, \
                                ''                                   entity_date, \
                                municipal_services                   entity_text, \
                                'RATE_DOCUMENT'                      entity_category, \
                                '4'                                  entity_type, \
                                ''                                   ft_identifying_numbers, \
                                place                                ft_location, \
                                names                                ft_name, \
                                ''                                   ft_description, \
                                ''                                   ft_short_name, \
                                tegs                                 ft_tag, \
                                converted_content                    ft_text_files, \
                                file_name                            entity_file_name, \
                                subject                              entity_location, \
                                to_char(effective_period_to, 'YYYY') entity_year, \
                                ''                                   longitude, \
                                ''                                   latitude, \
                                ''                                   entity_ogrn, \
                                ''                                   entity_inn, \
                                0                                    entity_deleted, \
                                ''                                   entity_role_codes, \
                                ''                                   entity_link \
                              FROM srchsm_demo.search_doc_rates t \
                              WHERE \
                                t.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wt l \
                                  WHERE l.object_type = 'WT' \
                                        AND l.object_id = t.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                     id, \
                                object_guid                            entity_uid, \
                                address                                entity_title, \
                                ''                                     entity_date, \
                                ('\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u044B\u0439 \u043F\u0430\u0441\u043F\u043E\u0440\u0442 \u0434\u043E\u043C\u0430. \u041E\u0442\u0447\u0435\u0442\u043D\u044B\u0439 \u043F\u0435\u0440\u0438\u043E\u0434: ' || reporting_period_month || '.' || \
                                 reporting_period_year)                entity_text, \
                                'EP_JD'                                entity_category, \
                                '10'                                   entity_type, \
                                doc_numbers                            ft_identifying_numbers, \
                                place                                  ft_location, \
                                names                                  ft_name, \
                                ''                                     ft_description, \
                                ''                                     ft_short_name, \
                                tegs                                   ft_tag, \
                                ''                                     ft_text_files, \
                                ''                                     entity_file_name, \
                                address                                entity_location, \
                                to_char(reporting_period_year, 'YYYY') entity_year, \
                                ''                                     longitude, \
                                ''                                     latitude, \
                                ''                                     entity_ogrn, \
                                ''                                     entity_inn, \
                                0                                      entity_deleted, \
                                ''                                     entity_role_codes, \
                                object_guid                            entity_link \
                              FROM srchsm_demo.search_passports_dwelling h \
                              WHERE \
                                h.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wh l \
                                  WHERE l.object_type = 'WH' \
                                        AND l.object_id = h.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                     id, \
                                object_guid                            entity_uid, \
                                address                                entity_title, \
                                ''                                     entity_date, \
                                ('\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u044B\u0439 \u043F\u0430\u0441\u043F\u043E\u0440\u0442 \u0434\u043E\u043C\u0430. \u041E\u0442\u0447\u0435\u0442\u043D\u044B\u0439 \u043F\u0435\u0440\u0438\u043E\u0434: ' || reporting_period_month || '.' || \
                                 reporting_period_year)                entity_text, \
                                'EP_MKD'                               entity_category, \
                                '9'                                    entity_type, \
                                doc_numbers                            ft_identifying_numbers, \
                                place                                  ft_location, \
                                names                                  ft_name, \
                                ''                                     ft_description, \
                                ''                                     ft_short_name, \
                                tegs                                   ft_tag, \
                                ''                                     ft_text_files, \
                                ''                                     entity_file_name, \
                                address                                entity_location, \
                                to_char(reporting_period_year, 'YYYY') entity_year, \
                                ''                                     longitude, \
                                ''                                     latitude, \
                                ''                                     entity_ogrn, \
                                ''                                     entity_inn, \
                                0                                      entity_deleted, \
                                ''                                     entity_role_codes, \
                                object_guid                            entity_link \
                              FROM srchsm_demo.search_passports_apartment a \
                              WHERE \
                                a.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wa l \
                                  WHERE l.object_type = 'WA' \
                                        AND l.object_id = a.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                   id, \
                                object_guid          entity_uid, \
                                address              entity_title, \
                                ''                   entity_date, \
                                house_type_name      entity_text, \
                                'HOUSES'             entity_category, \
                                '7'                  entity_type, \
                                doc_numbers          ft_identifying_numbers, \
                                place                ft_location, \
                                names                ft_name, \
                                ''                   ft_description, \
                                ''                   ft_short_name, \
                                tegs                 ft_tag, \
                                ''                   ft_text_files, \
                                ''                   entity_file_name, \
                                address              entity_location, \
                                ''                   entity_year, \
                                longitude :: VARCHAR longitude, \
                                latitude :: VARCHAR  latitude, \
                                ''                   entity_ogrn, \
                                ''                   entity_inn, \
                                0                    entity_deleted, \
                                ''                   entity_role_codes, \
                                ''                   entity_link \
                              FROM srchsm_demo.search_houses b \
                              WHERE \
                                b.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wb l \
                                  WHERE l.object_type = 'WB' \
                                        AND l.object_id = b.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                                                 id, \
                                object_guid                                                        entity_uid, \
                                names                                                              entity_title, \
                                round(extract(EPOCH FROM last_changed_date) :: NUMERIC) :: VARCHAR entity_date, \
                                oktmo_full_name                                                    entity_text, \
                                'INFRASTRUCTURE_DOCUMENTS'                                         entity_category, \
                                '11'                                                               entity_type, \
                                ''                                                                 ft_identifying_numbers, \
                                place                                                              ft_location, \
                                names                                                              ft_name, \
                                oktmo_full_name                                                    ft_description, \
                                ''                                                                 ft_short_name, \
                                tegs                                                               ft_tag, \
                                ''                                                                 ft_text_files, \
                                ''                                                                 entity_file_name, \
                                ''                                                                 entity_location, \
                                to_char(reporting_period_year, 'YYYY')                             entity_year, \
                                ''                                                                 longitude, \
                                ''                                                                 latitude, \
                                ''                                                                 entity_ogrn, \
                                ''                                                                 entity_inn, \
                                0                                                                  entity_deleted, \
                                ''                                                                 entity_role_codes, \
                                ''                                                                 entity_link \
                              FROM srchsm_demo.search_infr_documents k \
                              WHERE \
                                k.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wk l \
                                  WHERE l.object_type = 'WK' \
                                        AND l.object_id = k.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                                            id, \
                                object_guid                                                   entity_uid, \
                                title                                                         entity_title, \
                                round(extract(EPOCH FROM publish_date) :: NUMERIC) :: VARCHAR entity_date, \
                                short_text                                                    entity_text, \
                                'News'                                                        entity_category, \
                                '1'                                                           entity_type, \
                                doc_numbers                                                   ft_identifying_numbers, \
                                place                                                         ft_location, \
                                names                                                         ft_name, \
                                descriptions                                                  ft_description, \
                                ''                                                            ft_short_name, \
                                tegs                                                          ft_tag, \
                                ''                                                            ft_text_files, \
                                ''                                                            entity_file_name, \
                                ''                                                            entity_location, \
                                ''                                                            entity_year, \
                                ''                                                            longitude, \
                                ''                                                            latitude, \
                                ''                                                            entity_ogrn, \
                                ''                                                            entity_inn, \
                                0                                                             entity_deleted, \
                                ''                                                            entity_role_codes, \
                                ''                                                            entity_link \
                              FROM srchsm_demo.search_news n \
                              WHERE \
                                n.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wn l \
                                  WHERE l.object_type = 'WN' \
                                        AND l.object_id = n.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                   id, \
                                object_guid          entity_uid, \
                                organization_name    entity_title, \
                                ''                   entity_date, \
                                roles                entity_text, \
                                'ORGANIZATIONS'      entity_category, \
                                '8'                  entity_type, \
                                doc_numbers          ft_identifying_numbers, \
                                place                ft_location, \
                                names                ft_name, \
                                ''                   ft_description, \
                                ''                   ft_short_name, \
                                ''                   ft_tag, \
                                ''                   ft_text_files, \
                                ''                   entity_file_name, \
                                fact_addr            entity_location, \
                                ''                   entity_year, \
                                longitude :: VARCHAR longitude, \
                                latitude :: VARCHAR  latitude, \
                                ogrn                 entity_ogrn, \
                                inn                  entity_inn, \
                                0                    entity_deleted, \
                                ''                   entity_role_codes, \
                                ''                   entity_link \
                              FROM srchsm_demo.search_organizations o \
                              WHERE \
                                o.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wo l \
                                  WHERE l.object_type = 'WO' \
                                        AND l.object_id = o.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id                                                          id, \
                                object_guid                                                 entity_uid, \
                                title                                                       entity_title, \
                                round(extract(EPOCH FROM event_date) :: NUMERIC) :: VARCHAR entity_date, \
                                ''                                                          entity_text, \
                                'PEOPLE_EVENTS'                                             entity_category, \
                                '5'                                                         entity_type, \
                                ''                                                          ft_identifying_numbers, \
                                place                                                       ft_location, \
                                names                                                       ft_name, \
                                descriptions                                                ft_description, \
                                ''                                                          ft_short_name, \
                                tegs                                                        ft_tag, \
                                ''                                                          ft_text_files, \
                                ''                                                          entity_file_name, \
                                place                                                       entity_location, \
                                ''                                                          entity_year, \
                                ''                                                          longitude, \
                                ''                                                          latitude, \
                                ''                                                          entity_ogrn, \
                                ''                                                          entity_inn, \
                                0                                                           entity_deleted, \
                                ''                                                          entity_role_codes, \
                                ''                                                          entity_link \
                              FROM srchsm_demo.search_people_events v \
                              WHERE \
                                v.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wv l \
                                  WHERE l.object_type = 'WV' \
                                        AND l.object_id = v.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                              UNION ALL \
                              SELECT \
                                id              id, \
                                object_guid     entity_uid, \
                                link_name       entity_title, \
                                ''              entity_date, \
                                link_desc       entity_text, \
                                'USEFULL_LINKS' entity_category, \
                                '6'             entity_type, \
                                ''              ft_identifying_numbers, \
                                ''              ft_location, \
                                names           ft_name, \
                                descriptions    ft_description, \
                                ''              ft_short_name, \
                                ''              ft_tag, \
                                ''              ft_text_files, \
                                ''              entity_file_name, \
                                ''              entity_location, \
                                ''              entity_year, \
                                ''              longitude, \
                                ''              latitude, \
                                ''              entity_ogrn, \
                                ''              entity_inn, \
                                0               entity_deleted, \
                                ''              entity_role_codes, \
                                link_url        entity_link \
                              FROM srchsm_demo.search_useful_links ul \
                              WHERE \
                                ul.indexing_ready = true \
                                AND EXISTS( \
                                  SELECT 1 \
                                  FROM srchsm_demo.search_update_list_wl l \
                                  WHERE l.object_type = 'WL' \
                                        AND l.object_id = ul.id \
                                        AND l.update_date >= to_timestamp( $start / 1000000 - 1) \
                                        AND l.update_date <= to_timestamp($end / 1000000 + 1) \
                                        AND l.operation IN ('I', 'U') \
                              ) \
                            ) alltbls

delta.main.delta.sql_range_step = 3600000000

delta.main.delta.sql_query_pre = update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_ws where object_type='WS' ) where object_type='S'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wz where object_type='WZ' ) where object_type='Z'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wt where object_type='WT' ) where object_type='T'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wh where object_type='WH' ) where object_type='H'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wa where object_type='WA' ) where object_type='A'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wb where object_type='WB' ) where object_type='B'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wk where object_type='WK' ) where object_type='ID'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wn where object_type='WN' ) where object_type='N'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wo where object_type='WO' ) where object_type='O'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wv where object_type='WV' ) where object_type='V'; \
                                 update srchsm_demo.search_update_indexer set index_date = (select max(update_date) from srchsm_demo.search_update_list_wl where object_type='WL' ) where object_type='L';

delta.main.delta.sql_query_range = select min(min_ts), max(max_ts) from ( \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_ws l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'S' AND l.object_type = 'WS' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wz l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'Z' AND l.object_type = 'WZ' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wt l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'T' AND l.object_type = 'WT' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wh l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'H' AND l.object_type = 'WH' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wa l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'A' AND l.object_type = 'WA' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wb l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'B' AND l.object_type = 'WB' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wk l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'ID' AND l.object_type = 'WK' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wn l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'N' AND l.object_type = 'WN' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wo l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'O' AND l.object_type = 'WO' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wv l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'V' AND l.object_type = 'WV' \
                                     UNION ALL \
                                     SELECT \
                                       round(extract(EPOCH FROM min(l.update_date)) :: NUMERIC * 1000000) min_ts, \
                                       round(extract(EPOCH FROM max(d.index_date)) :: NUMERIC * 1000000)  max_ts \
                                     FROM srchsm_demo.search_update_list_wl l, srchsm_demo.search_update_indexer d \
                                     WHERE d.object_type = 'L' AND l.object_type = 'WL' \
                                   ) extrs

delta.main.delta.sql_query_post_index = update srchsm_demo.search_update_indexer set merge_date = index_date where object_type IN ('S', 'Z', 'T', 'H', 'A', 'B', 'ID', 'N', 'O', 'V', 'L')

delta.main.delete.scheme.request = select object_id from ( \
                                   SELECT object_id FROM srchsm_demo.search_update_list_ws WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wz WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wt WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wh WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wa WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wb WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wk WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wn WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wo WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wv WHERE operation = 'D' OR indexing_ready=false \
                                   UNION ALL \
                                   SELECT object_id FROM srchsm_demo.search_update_list_wl WHERE operation = 'D' OR indexing_ready=false \
                                   ) kls
fields.count = 24
field.id.name = id
field2.name = entity_uid
field2.type = sql_attr_string
field3.name = entity_title
field3.type = sql_field_string
field4.name = entity_date
field4.type = sql_attr_timestamp
field5.name = entity_text
field5.type = sql_field
field6.name = entity_category
field6.type = sql_attr_string
field7.name = entity_type
field7.type = sql_attr_uint
field8.name = ft_identifying_numbers
field8.type = sql_field_string
field9.name = ft_location
field9.type = sql_field_string
field10.name = ft_name
field10.type = sql_field_string
field11.name = ft_description
field11.type = sql_field_string
field12.name = ft_short_name
field12.type = sql_field_string
field13.name = ft_tag
field13.type = sql_field_string
field14.name = ft_text_files
field14.type = sql_field
field15.name = entity_file_name
field15.type = sql_attr_string
field16.name = entity_location
field16.type = sql_attr_string
field17.name = entity_year
field17.type = sql_attr_uint
field18.name = longitude
field18.type = sql_attr_float
field19.name = latitude
field19.type = sql_attr_float
field20.name = entity_ogrn
field20.type = sql_attr_string
field21.name = entity_inn
field21.type = sql_attr_string
field22.name = entity_deleted
field22.type = sql_attr_uint
field23.name = entity_role_codes
field23.type = sql_attr_string
field24.name = entity_link
field24.type = sql_attr_string
field.additional.for.full.indexing =
replica1.search.port=9322
replica1.distributed.search.port=9422
cron.delta = 0 30 * * * ?
cron.main = 0 10 /2 * * ?
delta.main.external.action.code=DELETE FROM srchsm_demo.search_update_list_ws WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'S' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wz WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'Z' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wt WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'T' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wh WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'H' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wa WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'A' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wb WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'B' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wk WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'ID' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wn WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'N' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wo WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'O' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wv WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'V' \
                                ); \
                                DELETE FROM srchsm_demo.search_update_list_wl WHERE update_date <= ( \
                                  SELECT MIN(merge_date) FROM srchsm_demo.search_update_indexer WHERE srchsm_demo.search_update_indexer.object_type = 'L' \
                                );
delta.main.datasource.table = delta
delta.main.id.to.find.value=5840
delta.main.expected.value.part=2
replica2.search.port=9317
replica2.distributed.search.port=9417
replica3.search.port=9318
replica3.distributed.search.port=9418
repair.delta.main.index.port=9319
repair.delta.main.distributed.index.port=9419
